{% extends "navbar.html" %}
{% load static %}

{% block title %}Events - Ideavate{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-16">
    <h1 class="text-4xl font-bold text-center text-gray-800 mb-10">Upcoming Events</h1>

    <!-- Refined Search Section -->
    <form method="GET" action="{% url 'events' %}" class="flex justify-center mb-8 bg-gray-50 p-4 rounded-lg shadow-lg max-w-2xl mx-auto">
        <div class="relative w-full">
            <!-- Search Input -->
            <input type="text" name="q" placeholder="Search events..." value="{{ request.GET.q }}"
                class="border border-gray-300 rounded-lg px-6 py-3 w-full focus:ring-2 focus:ring-blue-500 transition duration-300 ease-in-out text-lg shadow-sm placeholder-gray-500">
            
            <!-- Search Button -->
            <button type="submit" class="absolute right-2 top-2 bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-300 ease-in-out">
                <!-- SVG Icon for Search -->
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a7 7 0 100 14 7 7 0 000-14zm0 0v.01M12 20h-1m0-16h1m-1 0l1 1-1 1m-1 0h2l1-1-1-1m2 16h-2"/>
                </svg>
            </button>
        </div>
    </form>

    {% if events %}
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mt-8">
        {% for event in events %}
        <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 ease-in-out transform hover:scale-105 flex flex-col">
            
            <!-- Organization Profile Picture Top Left -->
            <div class="absolute top-4 left-4 z-10 flex flex-col items-center bg-white bg-opacity-80 rounded-full p-1 shadow-md transition-all duration-300 ease-in-out">
                <a href="{% url 'organization_profile' event.user.username %}">
                    {% if event.user.is_organization and event.user.organization_profile.profile_picture %}
                        <img src="{{ event.user.organization_profile.profile_picture.url }}" 
                             class="h-14 w-14 rounded-full object-cover border-4 border-white shadow-lg" alt="Org Profile">
                    {% else %}
                        <img src="{% static 'images/default-profile.png' %}" 
                             class="h-14 w-14 rounded-full object-cover border-4 border-white shadow-lg" alt="Default Profile">
                    {% endif %}
                </a>
                <p class="text-xs text-gray-700 mt-2 text-center font-medium tracking-wide">{{ event.user.username }}</p>
            </div>

            <!-- Event Image -->
            <div class="relative w-full h-48">
                <img src="{{ event.image.url }}" alt="{{ event.title }}" class="w-full h-full object-cover rounded-t-lg shadow-md">
                <div class="absolute top-0 left-0 right-0 bottom-0 bg-black bg-opacity-25 flex justify-center items-center rounded-t-lg">
                    <p class="text-white text-lg font-bold">{{ event.title }}</p>
                </div>
            </div>

            <!-- Event Details -->
            <div class="p-6 flex flex-col justify-between flex-grow">
                <p class="text-gray-600 mt-2 flex-grow">{{ event.description|truncatewords:20 }}</p>
                
                <!-- View Details Button -->
                <a href="{% url 'event_details' event.id %}" class="mt-4 text-center text-white bg-blue-600 hover:bg-blue-700 py-2 px-6 rounded-lg transform transition-all duration-300 ease-in-out flex-shrink-0">
                    View Details
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-center text-gray-600">No upcoming events available.</p>
    {% endif %}
</div>
{% endblock %}
